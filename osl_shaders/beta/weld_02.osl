float difference(color input, color pick, float tolerance)
{
    if (pick == 0)
    {
        return 0;
    }
    else
    {
        color difference = 0;
        float differenceF = 0;
        difference=sqrt(pow((pick[0]-input[0]), 2)+pow((pick[1]-input[1]), 2)+pow((pick[2]-input[2]), 2));
        differenceF = difference[0];
        differenceF = (differenceF-0)/(tolerance-0);
        differenceF = mix(0, 1, differenceF);
        differenceF = 1-differenceF;
        differenceF = clamp(differenceF, 0, 1);
        return differenceF;
    }

}

shader welding(
    float tol = 0.25,
    output float Result = 0,
)
{

    point PP = transform("object", P);
    float x[96] = {-0.6219626665115356, -0.5563328266143799, -0.6219626665115356, -0.7073320746421814, -0.5167614221572876, -0.5037010908126831, -0.5167614221572876, -0.5563328266143799, -0.5176050066947937, -0.5576273202896118, -0.5176050066947937, -0.5037010908126831, -0.6229221820831299, -0.7080501914024353, -0.6229221820831299, -0.5576273202896118, -0.8075722455978394, -0.7751980423927307, -0.8075722455978394, -0.7080501914024353, -0.4646376669406891, -0.045415639877319336, -0.4646376669406891, -0.7751980423927307, 0.31294262409210205, 0.5881011486053467, 0.31294262409210205, -0.045415639877319336, 0.7577221393585205, 0.816195011138916, 0.7577221393585205, 0.5881011486053467, 0.7579069137573242, 0.5881597995758057, 0.7579069137573242, 0.816195011138916, 0.31225526332855225, -0.04634428024291992, 0.31225526332855225, 0.5881597995758057, -0.46417611837387085, -0.7733867764472961, -0.46417611837387085, -0.04634428024291992, -0.8061228394508362, -0.7073320746421814, -0.8061228394508362, -0.7733867764472961, -2.8730146884918213, -2.841982841491699, -2.8730146884918213, -2.911299705505371, -2.82248592376709, -2.8152337074279785, -2.82248592376709, -2.841982841491699, -2.8209362030029297, -2.8381004333496094, -2.8209362030029297, -2.8152337074279785, -2.865234375, -2.9018735885620117, -2.865234375, -2.8381004333496094, -2.9475550651550293, -2.8970978260040283, -2.9475550651550293, -2.9018735885620117, -2.6453194618225098, -2.3171310424804688, -2.6453194618225098, -2.8970978260040283, -2.0374441146850586, -1.8224327564239502, -2.0374441146850586, -2.3171310424804688, -1.6882710456848145, -1.6413466930389404, -1.6882710456848145, -1.8224327564239502, -1.6880459785461426, -1.8228273391723633, -1.6880459785461426, -1.6413466930389404, -2.040149688720703, -2.3211636543273926, -2.040149688720703, -1.8228273391723633, -2.647021770477295, -2.89754581451416, -2.647021770477295, -2.3211636543273926, -2.9525580406188965, -2.911299705505371, -2.9525580406188965, -2.89754581451416};
    float y[96] = {0.19364887475967407, 0.3934083580970764, 0.19364887475967407, 0.039642512798309326, 0.6266614198684692, 0.8766615390777588, 0.6266614198684692, 0.3934083580970764, 1.1266615390777588, 1.3599145412445068, 1.1266615390777588, 0.8766615390777588, 1.5596740245819092, 1.7136805057525635, 1.5596740245819092, 1.3599145412445068, 1.8096742630004883, 1.8431679010391235, 1.8096742630004883, 1.7136805057525635, 1.8096742630004883, 1.713680624961853, 1.8096742630004883, 1.8431679010391235, 1.5596742630004883, 1.3599145412445068, 1.5596742630004883, 1.713680624961853, 1.1266615390777588, 0.8766615390777588, 1.1266615390777588, 1.3599145412445068, 0.6266614198684692, 0.3934083580970764, 0.6266614198684692, 0.8766615390777588, 0.19364875555038452, 0.039642393589019775, 0.19364875555038452, 0.3934083580970764, -0.05635124444961548, -0.08984494209289551, -0.05635124444961548, 0.039642393589019775, -0.056351304054260254, 0.039642512798309326, -0.056351304054260254, -0.08984494209289551, 0.19364875555038452, 0.3934083580970764, 0.19364875555038452, 0.039642512798309326, 0.6266614198684692, 0.8766615390777588, 0.6266614198684692, 0.3934083580970764, 1.1266615390777588, 1.3599145412445068, 1.1266615390777588, 0.8766615390777588, 1.5596742630004883, 1.713680624961853, 1.5596742630004883, 1.3599145412445068, 1.8096742630004883, 1.8431679010391235, 1.8096742630004883, 1.713680624961853, 1.8096742630004883, 1.713680624961853, 1.8096742630004883, 1.8431679010391235, 1.5596742630004883, 1.3599145412445068, 1.5596742630004883, 1.713680624961853, 1.1266615390777588, 0.8766615390777588, 1.1266615390777588, 1.3599145412445068, 0.6266614198684692, 0.39340853691101074, 0.6266614198684692, 0.8766615390777588, 0.19364899396896362, 0.03964275121688843, 0.19364899396896362, 0.39340853691101074, -0.05635112524032593, -0.08984458446502686, -0.05635112524032593, 0.03964275121688843, -0.05635100603103638, 0.039642512798309326, -0.05635100603103638, -0.08984458446502686};
    float z[96] = {-1.9351005554199219, -1.7667427062988281, -1.9351005554199219, -2.1527655124664307, -1.6599076986312866, -1.6214832067489624, -1.6599076986312866, -1.7667427062988281, -1.6583561897277832, -1.7641375064849854, -1.6583561897277832, -1.6214832067489624, -1.9324378967285156, -2.1501739025115967, -1.9324378967285156, -1.7641375064849854, -2.404261827468872, -2.652743101119995, -2.404261827468872, -2.1501739025115967, -2.853659152984619, -3.018501043319702, -2.853659152984619, -2.652743101119995, -3.158759117126465, -3.2654471397399902, -3.158759117126465, -3.018501043319702, -3.329578161239624, -3.3510348796844482, -3.329578161239624, -3.2654471397399902, -3.3297009468078613, -3.2654926776885986, -3.3297009468078613, -3.3510348796844482, -3.158328056335449, -3.018238067626953, -3.158328056335449, -3.2654926776885986, -2.8552541732788086, -2.6561055183410645, -2.8552541732788086, -3.018238067626953, -2.4075214862823486, -2.1527655124664307, -2.4075214862823486, -2.6561055183410645, 1.091491937637329, 1.3046965599060059, 1.091491937637329, 0.8123699426651001, 1.4373865127563477, 1.4830949306488037, 1.4373865127563477, 1.3046965599060059, 1.4353551864624023, 1.2996078729629517, 1.4353551864624023, 1.4830949306488037, 1.0812937021255493, 0.8000138401985168, 1.0812937021255493, 1.2996078729629517, 0.4753706455230713, 0.20318764448165894, 0.4753706455230713, 0.8000138401985168, 0.07928809523582458, 0.03370434045791626, 0.07928809523582458, 0.20318764448165894, -0.003531336784362793, -0.031431496143341064, -0.003531336784362793, 0.03370434045791626, -0.04900920391082764, -0.055291056632995605, -0.04900920391082764, -0.031431496143341064, -0.04930377006530762, -0.030913174152374268, -0.04930377006530762, -0.055291056632995605, 1.5437602996826172e-05, 0.03899037837982178, 1.5437602996826172e-05, -0.030913174152374268, 0.08152022957801819, 0.2037758231163025, 0.08152022957801819, 0.03899037837982178, 0.48192861676216125, 0.8123699426651001, 0.48192861676216125, 0.2037758231163025};
    float mask = 0;
    for (int i = 0; i < 95; i++){
        point pos = point(x[i], y[i], z[i]);
        mask += difference(PP, pos, tol);
    }
    mask = clamp(mask, 0, 1);
    Result = mask;
}
